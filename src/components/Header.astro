---
// Aquí podrías incluir lógica si lo necesitas (por ejemplo, props)
import {TITLE} from '../consts';
import '../style/header.css';
import '../style/global.css';
---

<header class="site-header visible">
  <div class="menu-left">
    <ul class="nav-menu-left">
      <li class="menu-item">
        <span class="menu-link">Nosotros</span>
        <ul class="submenu">
          <li class="submenu-header">Conoce a LERRETI</li>
          <li><a href="/historia">Nuestra Historia</a></li>
          <li><a href="/somos">Quiénes somos</a></li>
          <li><a href="/profesionalizacion">Profesionalización</a></li>
        </ul>
      </li>
      <li><a href="/#service" class="menu-link">Servicios</a></li>
    </ul>
  </div>

  <div class="logo-banner">
    <a href="/#"><img src={TITLE} alt="Logo" /></a>
  </div>

  <div class="menu-right">
    <ul class="nav-menu-right">
      <li><a href="/#principios" class="menu-link">Nuestros Principios</a></li>
      <li><a href="/Distinciones" class="menu-link">Distinciones</a></li>
    </ul>
  </div>
</header>

<div id="overlay" class="overlay"></div>



<script>
document.addEventListener('DOMContentLoaded', () => {
  const header = document.querySelector('.site-header');
  const sectionInicio = document.getElementById('Inicio');
  const menuItem = document.querySelector('.menu-item');
  const overlay = document.getElementById('overlay');
  const menuLink = menuItem?.querySelector('.menu-link'); // “Nosotros”
  const submenu = menuItem?.querySelector('.submenu');

  // --- Mostrar/ocultar header según scroll ---
  function toggleHeader() {
    if (!sectionInicio) return;

    const rect = sectionInicio.getBoundingClientRect();
    const visibleHeight = Math.min(rect.bottom, window.innerHeight) - Math.max(rect.top, 0);
    const visibleRatio = visibleHeight / rect.height;

    header.classList.toggle('visible', visibleRatio > 0.9);
  }

  window.addEventListener('scroll', toggleHeader);
  window.addEventListener('load', toggleHeader);

  // --- Submenú con clic ---
  if (menuItem && menuLink && submenu && overlay) {
    let submenuOpen = false;

    function openSubmenu() {
      submenu.classList.add('active');
      overlay.classList.add('active');
      menuLink.classList.add('active'); // ✅ resalta "Nosotros"
      submenuOpen = true;
    }

    function closeSubmenu() {
      submenu.classList.remove('active');
      overlay.classList.remove('active');
      menuLink.classList.remove('active'); // ✅ quita resaltado
      submenuOpen = false;
    }

    // Clic en "Nosotros"
    menuLink.addEventListener('click', (e) => {
      e.stopPropagation();
      submenuOpen ? closeSubmenu() : openSubmenu();
    });

    // Clic fuera o en overlay → cerrar
    document.addEventListener('click', (e) => {
      if (submenuOpen && !menuItem.contains(e.target)) closeSubmenu();
    });

    overlay.addEventListener('click', closeSubmenu);
  }
});
</script>

